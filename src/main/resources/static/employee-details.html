<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Employee Details</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body class="bg-gray-100 leading-relaxed text-gray-800">
<div id="navbar"></div>
<!-- Spinner Container -->
<!-- Spinner Container -->
<div id="spinner-container" class="spinner-container">
    <div class="stylish-spinner"></div>
</div>
<div class=" mx-auto my-0 p-6 bg-white shadow-lg rounded-lg">
    <h1 class="text-4xl text-center font-bold text-indigo-600 mb-6">Employee Details</h1>

    <form id="employeeForm">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- Personal Information -->
            <div>
                <label class="block text-sm font-bold text-gray-700">First Name</label>
                <input type="text" id="firstName" name="firstName" class="w-full mt-1 p-2 border rounded">
            </div>
            <div>
                <label class="block text-sm font-bold text-gray-700">Last Name</label>
                <input type="text" id="lastName" name="lastName" class="w-full mt-1 p-2 border rounded">
            </div>
            <div>
                <label class="block text-sm font-bold text-gray-700">Mobile Number</label>
                <input type="text" id="mobileNumber" name="mobileNumber" class="w-full mt-1 p-2 border rounded">
            </div>
            <div>
                <label class="block text-sm font-bold text-gray-700">Alternate Mobile Number</label>
                <input type="text" id="alternateMobileNumber" name="alternateMobileNumber" class="w-full mt-1 p-2 border rounded">
            </div>
            <div>
                <label class="block text-sm font-bold text-gray-700">Personal Email</label>
                <input type="email" id="personalEmail" name="personalEmail" class="w-full mt-1 p-2 border rounded">
            </div>
            <div>
                <label class="block text-sm font-bold text-gray-700">Professional Email</label>
                <input type="email" id="professionalEmail" name="professionalEmail" class="w-full mt-1 p-2 border rounded">
            </div>
            <div>
                <label class="block text-sm font-bold text-gray-700">Date of Birth</label>
                <input type="date" id="dateOfBirth" name="dateOfBirth" class="w-full mt-1 p-2 border rounded">
            </div>
            <div>
                <label class="block text-sm font-bold text-gray-700">Gender</label>
                <input type="text" id="gender" name="gender" class="w-full mt-1 p-2 border rounded">
            </div>
            <div>
                <label class="block text-sm font-bold text-gray-700">Home Address</label>
                <input type="text" id="homeAddress" name="homeAddress" class="w-full mt-1 p-2 border rounded">
            </div>
            <div>
                <label class="block text-sm font-bold text-gray-700">Aadhar Number</label>
                <input type="text" id="aadharNumber" name="aadharNumber" class="w-full mt-1 p-2 border rounded">
            </div>
            <div>
                <label class="block text-sm font-bold text-gray-700">PAN Number</label>
                <input type="text" id="panNumber" name="panNumber" class="w-full mt-1 p-2 border rounded">
            </div>

            <!-- Employment Information -->
            <div>
                <label class="block text-sm font-bold text-gray-700">Job Title</label>
                <input type="text" id="jobTitle" name="jobTitle" class="w-full mt-1 p-2 border rounded">
            </div>
            <div>
                <label class="block text-sm font-bold text-gray-700">Department</label>
                <input type="text" id="department" name="department" class="w-full mt-1 p-2 border rounded">
            </div>
            <div>
                <label class="block text-sm font-bold text-gray-700">Manager Name</label>
                <input type="text" id="managerName" name="managerName" class="w-full mt-1 p-2 border rounded">
            </div>
            <div>
                <label class="block text-sm font-bold text-gray-700">Employment Type</label>
                <input type="text" id="employmentType" name="employmentType" class="w-full mt-1 p-2 border rounded">
            </div>
            <div>
                <label class="block text-sm font-bold text-gray-700">Employee Status</label>
                <input type="text" id="employeeStatus" name="employeeStatus" class="w-full mt-1 p-2 border rounded">
            </div>
            <div>
                <label class="block text-sm font-bold text-gray-700">Work Location</label>
                <input type="text" id="workLocation" name="workLocation" class="w-full mt-1 p-2 border rounded">
            </div>
            <div>
                <label class="block text-sm font-bold text-gray-700">Current Location</label>
                <input type="text" id="currentLocation" name="currentLocation" class="w-full mt-1 p-2 border rounded">
            </div>
            <div>
                <label class="block text-sm font-bold text-gray-700">Employee Grade</label>
                <input type="text" id="employeeGrade" name="employeeGrade" class="w-full mt-1 p-2 border rounded">
            </div>
            <div>
                <label class="block text-sm font-bold text-gray-700">Date of Joining</label>
                <input type="date" id="dateOfJoining" name="dateOfJoining" class="w-full mt-1 p-2 border rounded">
            </div>
            <div>
                <label class="block text-sm font-bold text-gray-700">Date of Resigning</label>
                <input type="date" id="dateOfResigning" name="dateOfResigning" class="w-full mt-1 p-2 border rounded">
            </div>

            <!-- Payroll & Salary Information -->
            <div>
                <label class="block text-sm font-bold text-gray-700">Salary Per Annum</label>
                <input type="number" id="salaryPerAnnum" name="salaryPerAnnum" class="w-full mt-1 p-2 border rounded">
            </div>
            <div>
                <label class="block text-sm font-bold text-gray-700">Payroll</label>
                <input type="text" id="payroll" name="payroll" class="w-full mt-1 p-2 border rounded">
            </div>
            <div>
                <label class="block text-sm font-bold text-gray-700">Bank Account Details</label>
                <input type="text" id="bankAccountDetails" name="bankAccountDetails" class="w-full mt-1 p-2 border rounded">
            </div>
            <div>
                <label class="block text-sm font-bold text-gray-700">Pay Date</label>
                <input type="date" id="payDate" name="payDate" class="w-full mt-1 p-2 border rounded">
            </div>
            <div>
                <label class="block text-sm font-bold text-gray-700">Tax Information</label>
                <input type="text" id="taxInformation" name="taxInformation" class="w-full mt-1 p-2 border rounded">
            </div>

            <!-- Additional Details -->
            <div>
                <label class="block text-sm font-bold text-gray-700">Nominee Name</label>
                <input type="text" id="nomineeName" name="nomineeName" class="w-full mt-1 p-2 border rounded">
            </div>
            <div>
                <label class="block text-sm font-bold text-gray-700">Nominee Bank Account Details</label>
                <input type="text" id="nomineeBankAccountDetails" name="nomineeBankAccountDetails" class="w-full mt-1 p-2 border rounded">
            </div>
            <div>
                <label class="block text-sm font-bold text-gray-700">Insurance Plan Details</label>
                <input type="text" id="insurancePlanDetails" name="insurancePlanDetails" class="w-full mt-1 p-2 border rounded">
            </div>
            <div>
                <label class="block text-sm font-bold text-gray-700">Leaves Balance</label>
                <input type="number" id="leavesBalance" name="leavesBalance" class="w-full mt-1 p-2 border rounded">
            </div>
            <div>
                <label class="block text-sm font-bold text-gray-700">Other Benefits</label>
                <input type="text" id="otherBenefits" name="otherBenefits" class="w-full mt-1 p-2 border rounded">
            </div>
        </div>

        <button type="submit" class="mt-6 bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded">
            Save Changes
        </button>
    </form>
</div>
<footer id="footer"></footer>
<script>
    // Show the spinner for a few seconds while loading content
    document.addEventListener("DOMContentLoaded", function() {
        // Simulate content loading with a timeout
        setTimeout(function() {
            document.getElementById("spinner-container").style.display = "none";  // Hide spinner after loading
        }, 1100); // Adjust the delay based on your requirements
    });
    fetch('navbar.html')
        .then(response => response.text())
        .then(data => {
            document.getElementById('navbar').innerHTML = data;
        });

    fetch('footer.html')
        .then(response => response.text())
        .then(data => {
            document.getElementById('footer').innerHTML = data;
        });
    const urlParams = new URLSearchParams(window.location.search);
    const employeeId = urlParams.get('id');

    async function fetchEmployeeDetails() {
        try {
            const response = await fetch(`http://3.6.108.76:8080/employees/${employeeId}`);
            if (!response.ok) throw new Error('Employee not found');
            const employee = await response.json();
            console.log("employee data:",employee);

            // Populate all fields
            document.getElementById('firstName').value = employee.firstName || '';
            document.getElementById('lastName').value = employee.lastName || '';
            document.getElementById('mobileNumber').value = employee.mobileNumber || '';
            document.getElementById('alternateMobileNumber').value = employee.alternateMobileNumber || '';
            document.getElementById('personalEmail').value = employee.personalEmail || '';
            document.getElementById('professionalEmail').value = employee.professionalEmail || '';
            document.getElementById('dateOfBirth').value = employee.dateOfBirth || '';
            document.getElementById('gender').value = employee.gender || '';
            document.getElementById('homeAddress').value = employee.homeAddress || '';
            document.getElementById('aadharNumber').value = employee.aadharNumber || '';
            document.getElementById('panNumber').value = employee.panNumber || '';
            document.getElementById('jobTitle').value = employee.jobTitle || '';
            document.getElementById('department').value = employee.department || '';
            document.getElementById('managerName').value = employee.managerName || '';
            document.getElementById('employmentType').value = employee.employmentType || '';
            document.getElementById('employeeStatus').value = employee.employeeStatus || '';
            document.getElementById('workLocation').value = employee.workLocation || '';
            document.getElementById('currentLocation').value = employee.currentLocation || '';
            document.getElementById('employeeGrade').value = employee.employeeGrade || '';
            document.getElementById('dateOfJoining').value = employee.dateOfJoining || '';
            document.getElementById('dateOfResigning').value = employee.dateOfResigning || '';
            document.getElementById('salaryPerAnnum').value = employee.payroll || '';
            document.getElementById('payroll').value = employee.payroll || '';
            document.getElementById('bankAccountDetails').value = employee.bankAccountDetails || '';
            document.getElementById('payDate').value = employee.payDate || '';
            document.getElementById('taxInformation').value = employee.taxInformation || '';
            document.getElementById('nomineeName').value = employee.nomineeName || '';
            document.getElementById('nomineeBankAccountDetails').value = employee.nomineeBankAccountDetails || '';
            document.getElementById('insurancePlanDetails').value = employee.insurancePlanDetails || '';
            document.getElementById('leavesBalance').value = employee.leavesBalance || '';
            document.getElementById('otherBenefits').value = employee.otherBenefits || '';
        } catch (error) {
            Swal.fire('Error', 'Failed to load employee details', 'error');
        }
    }

    document.addEventListener('DOMContentLoaded', fetchEmployeeDetails);

    document.getElementById('employeeForm').addEventListener('submit', async (event) => {
        event.preventDefault();

        const updatedEmployee = {
            firstName: document.getElementById('firstName').value,
            lastName: document.getElementById('lastName').value,
            mobileNumber: document.getElementById('mobileNumber').value,
            alternateMobileNumber: document.getElementById('alternateMobileNumber').value,
            personalEmail: document.getElementById('personalEmail').value,
            professionalEmail: document.getElementById('professionalEmail').value,
            dateOfBirth: document.getElementById('dateOfBirth').value,
            gender: document.getElementById('gender').value,
            homeAddress: document.getElementById('homeAddress').value,
            aadharNumber: document.getElementById('aadharNumber').value,
            panNumber: document.getElementById('panNumber').value,
            jobTitle: document.getElementById('jobTitle').value,
            department: document.getElementById('department').value,
            managerName: document.getElementById('managerName').value,
            employmentType: document.getElementById('employmentType').value,
            employeeStatus: document.getElementById('employeeStatus').value,
            workLocation: document.getElementById('workLocation').value,
            currentLocation: document.getElementById('currentLocation').value,
            employeeGrade: document.getElementById('employeeGrade').value,
            dateOfJoining: document.getElementById('dateOfJoining').value,
            dateOfResigning: document.getElementById('dateOfResigning').value,
            salaryPerAnnum: document.getElementById('salaryPerAnnum').value,
            payroll: document.getElementById('payroll').value,
            bankAccountDetails: document.getElementById('bankAccountDetails').value,
            payDate: document.getElementById('payDate').value,
            taxInformation: document.getElementById('taxInformation').value,
            nomineeName: document.getElementById('nomineeName').value,
            nomineeBankAccountDetails: document.getElementById('nomineeBankAccountDetails').value,
            insurancePlanDetails: document.getElementById('insurancePlanDetails').value,
            leavesBalance: document.getElementById('leavesBalance').value,
            otherBenefits: document.getElementById('otherBenefits').value
        };

        try {
            const response = await fetch(`http://3.6.108.76:8080/employees/${employeeId}`, {
                method: 'PUT',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(updatedEmployee),
            });
            if (!response.ok) throw new Error('Failed to update employee');
            Swal.fire('Success', 'Employee details updated successfully', 'success');
        } catch (error) {
            Swal.fire('Error', 'Failed to update employee details', 'error');
        }
    });
</script>
<script src="navbar.js"></script>
</body>
</html>
